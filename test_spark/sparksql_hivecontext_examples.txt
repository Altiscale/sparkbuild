import org.apache.spark.SparkContext
import org.apache.spark.sql.hive._

val hiveContext = new org.apache.spark.sql.hive.HiveContext(sc)

import hiveContext._

// Create table and clean up data
hiveContext.hql("CREATE TABLE IF NOT EXISTS spark_hive_test_table (key INT, value STRING)")
hiveContext.hql("TRUNCATE TABLE spark_hive_test_table")

// load data
hiveContext.hql("LOAD DATA LOCAL INPATH '/opt/spark/examples/src/main/resources/kv1.txt' INTO TABLE spark_hive_test_table")

// Queries are expressed in HiveQL
hiveContext.hql("FROM spark_hive_test_table SELECT key, value").collect().foreach(println)

exit

